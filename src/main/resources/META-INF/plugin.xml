<idea-plugin>
    <id>yk.plugin.lly</id>

    <name>LayoutInspector-Y</name>

    <vendor email="" >ykk</vendor>

    <description><![CDATA[
This plugin is modified based on the old version of Layout Inspector and includes several convenient features. For system app developers, selecting specific windows to obtain layouts is crucial. However, the new version of AS Layout Inspector lacks this functionality, which is why this plugin is maintained and developed.

This project is developed based on https://github.com/pingfangx/androidstudiox and references the design of https://github.com/CoXier/LayoutInspectorV2-Pro. Tribute to pingfangx and CoXier.
    ]]></description>

    <change-notes><![CDATA[
    <b>1.0.0</b><br>
    <ul>
        <li>Supports V1 and V2 versions.Tip: V1 is slower but provides more detailed information, while V2 is faster with reduced output.</li>
        <li>Supports defining output filename format with variables.</li>
        <li>Supports the refresh button for quick re-acquisition of the layout.</li>
    </ul>
    ]]></change-notes>

    <!--base platform-->
    <depends>com.intellij.modules.platform</depends>
    <!--android plugin-->
    <depends>org.jetbrains.android</depends>
    <!--android studio module-->
    <!--suppress PluginXmlValidity: for android studio only-->
    <depends>com.intellij.modules.androidstudio</depends>

    <actions>
        <action id="yk.plugin.layoutinspector.LegacyLayoutInspectorAction"
                class="yk.plugin.layoutinspector.LegacyLayoutInspectorAction">
            <add-to-group group-id="AndroidToolsGroup"/>
        </action>
    </actions>

    <extensions defaultExtensionNs="com.intellij">
        <projectService serviceInterface="com.android.tools.idea.editors.layoutInspector.AndroidLayoutInspectorService"
                        serviceImplementation="com.android.tools.idea.editors.layoutInspector.impl.AndroidLayoutInspectorServiceImpl"/>
        <projectService serviceImplementation="com.android.tools.idea.profiling.capture.CaptureService"/>
        <applicationService serviceImplementation="com.android.tools.idea.profiling.capture.CaptureTypeService"/>
        <fileType name="Layout Inspector(V1)" extensions="liy"
                  implementationClass="yk.plugin.layoutinspector.LegacyLayoutInspectorFileTypeV1"
                  fieldName="INSTANCE"/>
        <fileEditorProvider
                implementation="yk.plugin.layoutinspector.LegacyLayoutInspectorEditorProviderV1"/>
        <fileType name="Layout Inspector(V2)" extensions="liy2"
                  implementationClass="yk.plugin.layoutinspector.LegacyLayoutInspectorFileTypeV2"
                  fieldName="INSTANCE"/>
        <fileEditorProvider
                implementation="yk.plugin.layoutinspector.LegacyLayoutInspectorEditorProviderV2"/>
    </extensions>
    <extensionPoints>
        <extensionPoint qualifiedName="yk.plugin.layoutinspector.captureType"
                        interface="com.android.tools.idea.profiling.capture.CaptureType"/>
    </extensionPoints>
    <extensions defaultExtensionNs="yk.plugin.layoutinspector">
        <captureType implementation="com.android.tools.idea.editors.layoutInspector.LayoutInspectorCaptureTypeV1"/>
    </extensions>
    <extensions defaultExtensionNs="yk.plugin.layoutinspector">
        <captureType implementation="com.android.tools.idea.editors.layoutInspector.LayoutInspectorCaptureTypeV2"/>
    </extensions>

    <extensions defaultExtensionNs="com.intellij">
        <applicationService
                            serviceImplementation="yk.plugin.layoutinspector.config.MyPluginSettings"/>
        <!-- IMPORTANT: 注册全局配置项入口 -->
        <applicationConfigurable
                groupId="tools"
                displayName="LayoutInspector-Y"
                id="MyPluginConfig"
                instance="yk.plugin.layoutinspector.config.MyPluginConfigurable"/>  <!-- 图标配置 -->
    </extensions>
    <!-- IMPORTANT: 声明 Kotlin 依赖 -->
    <depends>org.jetbrains.kotlin</depends>
    <extensions defaultExtensionNs="org.jetbrains.kotlin">
        <supportsKotlinPluginMode supportsK2="true"/> <!-- 关键配置：声明支持K2模式 -->
    </extensions>
</idea-plugin>
